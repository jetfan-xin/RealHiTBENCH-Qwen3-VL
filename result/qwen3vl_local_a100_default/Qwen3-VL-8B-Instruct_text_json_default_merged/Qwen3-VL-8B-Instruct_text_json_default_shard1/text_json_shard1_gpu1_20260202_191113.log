`torch_dtype` is deprecated! Use `dtype` instead!
Configuration:
  Model: /data/pan/4xin/models/Qwen3-VL-8B-Instruct
  Modality: text
  Format: json
  Data path: /data/pan/4xin/datasets/RealHiTBench
  Use Flash Attention: True
  Multi-GPU Mode: Model Parallel (device_map=auto)
  Sharding: Shard 2/3
  Generation Settings (Qwen3-VL Instruct Recommended):
    Temperature: 0.7
    Top-p: 0.8
    Top-k: 20
    Repetition Penalty: 1.0
    Presence Penalty: 1.5
    Max Tokens: 1024
  Batch size: 1

Loading Qwen3-VL model from /data/pan/4xin/models/Qwen3-VL-8B-Instruct...
Available GPUs: 1
Using MODEL PARALLELISM (device_map='auto') - layers distributed across GPUs
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:21<01:05, 21.83s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:43<00:42, 21.47s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [01:04<00:21, 21.37s/it]Loading checkpoint shards: 100%|██████████| 4/4 [01:16<00:00, 17.78s/it]Loading checkpoint shards: 100%|██████████| 4/4 [01:16<00:00, 19.15s/it]
Model loaded with flash_attention_2 attention
Model distributed across devices: {0}
Processor configured with OFFICIAL DEFAULT settings (no pixel restrictions)
  Note: Official defaults allow up to ~16.8M pixels per image
Successfully loaded F1, EM, ROUGE, SacreBLEU
Loaded QA file: QA_final_sc_filled.json (3071 queries)
Shard 1/3: Processing queries 1025-2048 (1024 queries)
Processing text modality:   0%|          | 0/1024 [00:00<?, ?it/s]Processing text modality:   0%|          | 1/1024 [00:03<55:22,  3.25s/it]Processing text modality:   0%|          | 2/1024 [00:04<33:51,  1.99s/it]Processing text modality:   0%|          | 3/1024 [00:05<25:23,  1.49s/it]Processing text modality:   0%|          | 4/1024 [00:12<1:05:53,  3.88s/it]Processing text modality:   0%|          | 5/1024 [00:14<50:10,  2.95s/it]  Processing text modality:   1%|          | 6/1024 [00:15<38:58,  2.30s/it]Processing text modality:   1%|          | 7/1024 [00:16<31:35,  1.86s/it]Processing text modality:   1%|          | 8/1024 [00:20<42:44,  2.52s/it]Processing text modality:   1%|          | 9/1024 [00:26<1:02:39,  3.70s/it]Processing text modality:   1%|          | 10/1024 [00:27<48:52,  2.89s/it] Processing text modality:   1%|          | 11/1024 [00:28<41:58,  2.49s/it]Processing text modality:   1%|          | 12/1024 [00:30<35:39,  2.11s/it]Processing text modality:   1%|▏         | 13/1024 [00:31<31:03,  1.84s/it]Processing text modality:   1%|▏         | 14/1024 [00:39<1:01:42,  3.67s/it]Processing text modality:   1%|▏         | 15/1024 [00:40<47:44,  2.84s/it]  Processing text modality:   2%|▏         | 16/1024 [00:41<39:29,  2.35s/it]Processing text modality:   2%|▏         | 17/1024 [00:42<33:14,  1.98s/it]Processing text modality:   2%|▏         | 18/1024 [00:44<32:07,  1.92s/it]
============================================================
Query ID: 1025 | Type: Fact Checking | SubType: Value-Matching
============================================================
Predictions:  ['20170304 075434 20170304 080239']
Answer:  ['805 trip1']
Prediction: 2017-03-04 07:54:34, 2017-03-04 08:02:39
Reference: 8:05, Trip1
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 3.25s

============================================================
Query ID: 1026 | Type: Numerical Reasoning | SubType: Counting
============================================================
Predictions:  ['adam max samrt lucas']
Answer:  ['4 adam max samrt lucas']
Prediction: ADAM, MAX, SAMRT, LUCAS
Reference: 4, ADAM, MAX, SAMRT, LUCAS.
Metrics: {'F1': 88.89, 'EM': 0.0, 'ROUGE-L': 88.89, 'SacreBLEU': 77.88}
Processing Time: 1.11s

============================================================
Query ID: 1027 | Type: Numerical Reasoning | SubType: Calculation
============================================================
Predictions:  ['76']
Answer:  ['95']
Prediction: 7.60
Reference: 9.50
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 0.90s

============================================================
Query ID: 1028 | Type: Data Analysis | SubType: Summary Analysis
============================================================
Prediction: OLIVER had the shortest trip (3 minutes, 21 seconds) from A1 to DU3, while LEWIS had the longest trip (30 minutes, 4 seconds) from an unspecified location to another, covering 23 km; MAX showed consis...
Reference: The table summarizes trip durations for users like OLIVER, SAMRT, MAX, ADAM, LUCAS, and LEWIS. OLIVER had the shortest trip at 3 minutes and 21 seconds, while LEWIS had the longest trip at 30 minutes....
Metrics: {'GPT_EVAL': 'N/A (no eval_api_key)'}
Processing Time: 7.53s

============================================================
Query ID: 1029 | Type: Fact Checking | SubType: Multi-hop Fact Checking
============================================================
Predictions:  ['125 125']
Answer:  ['250']
Prediction: 125, 125
Reference: 250
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 1.32s

============================================================
Query ID: 1030 | Type: Fact Checking | SubType: Value-Matching
============================================================
Predictions:  ['roast beef']
Answer:  ['roast beef']
Prediction: Roast Beef
Reference: Roast Beef
Metrics: {'F1': 100.0, 'EM': 100.0, 'ROUGE-L': 100.0, 'SacreBLEU': 0.0}
Processing Time: 1.02s

============================================================
Query ID: 1031 | Type: Numerical Reasoning | SubType: Counting
============================================================
Predictions:  ['2']
Answer:  ['2']
Prediction: 2
Reference: 2
Metrics: {'F1': 100.0, 'EM': 100.0, 'ROUGE-L': 100.0, 'SacreBLEU': 0.0}
Processing Time: 0.97s

============================================================
Query ID: 1032 | Type: Numerical Reasoning | SubType: Ranking
============================================================
Predictions:  ['20170104 000000 20170103 000000 20170102 000000']
Answer:  ['wed jan 04 tue jan 03 mon jan 02']
Prediction: 2017-01-04 00:00:00, 2017-01-03 00:00:00, 2017-01-02 00:00:00
Reference: Wed, Jan 04, Tue, Jan 03, Mon, Jan 02
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 3.94s

============================================================
Query ID: 1033 | Type: Data Analysis | SubType: Summary Analysis
============================================================
Prediction: Daily nutrition and activity logs for January 2-4, 2017, tracking food intake (KCAL, FAT, CARB, PROT), physical activities (MIN, MILES, REPS, SETS), and weight; key trends: high-calorie intake on Jan ...
Reference: The table records daily food consumption and physical activities, categorizing entries into Food and Activity. Key metrics include servings, calories (KCAL), macronutrient content (FAT, CARB, PROT), a...
Metrics: {'GPT_EVAL': 'N/A (no eval_api_key)'}
Processing Time: 6.30s

============================================================
Query ID: 1034 | Type: Fact Checking | SubType: Value-Matching
============================================================
Predictions:  ['weightlifting']
Answer:  ['weightlifting']
Prediction: WEIGHTLIFTING
Reference: Weightlifting
Metrics: {'F1': 100.0, 'EM': 100.0, 'ROUGE-L': 100.0, 'SacreBLEU': 0.0}
Processing Time: 1.07s
Checkpoint saved: 10 queries processed

============================================================
Query ID: 1035 | Type: Fact Checking | SubType: Inference-based Fact Checking
============================================================
Predictions:  ['20170203 6']
Answer:  ['20170202 21']
Prediction: 2017-02-03, 6
Reference: 2017-02-02, 21
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 1.57s

============================================================
Query ID: 1036 | Type: Numerical Reasoning | SubType: Calculation
============================================================
Predictions:  ['0 0 0']
Answer:  ['545']
Prediction: 0, 0, 0
Reference: 545
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 1.26s

============================================================
Query ID: 1037 | Type: Numerical Reasoning | SubType: Multi-hop Numerical Reasoning
============================================================
Predictions:  ['30 60']
Answer:  ['60']
Prediction: 30, 60
Reference: 60
Metrics: {'F1': 66.67, 'EM': 0.0, 'ROUGE-L': 66.67, 'SacreBLEU': 0.0}
Processing Time: 1.22s

============================================================
Query ID: 1038 | Type: Data Analysis | SubType: Summary Analysis
============================================================
Prediction: Daily nutrition intake (KCAL, FAT, CARB, PROT), physical activities (MIN, MILES, LBS, REPS, SETS), and weight tracking; key food items include fruits, grains, meats, oils, and beverages; key activitie...
Reference: The table tracks activities and food items across dates, with key columns for activity types, food categories, calorie counts, and time periods (morning, afternoon, evening). It highlights metrics lik...
Metrics: {'GPT_EVAL': 'N/A (no eval_api_key)'}
Processing Time: 7.88s

============================================================
Query ID: 1039 | Type: Fact Checking | SubType: Inference-based Fact Checking
============================================================
Predictions:  ['no']
Answer:  ['no']
Prediction: No
Reference: No
Metrics: {'F1': 100.0, 'EM': 100.0, 'ROUGE-L': 100.0, 'SacreBLEU': 0.0}
Processing Time: 0.92s

============================================================
Query ID: 1040 | Type: Fact Checking | SubType: Multi-hop Fact Checking
============================================================
Predictions:  ['30 30']
Answer:  ['675']
Prediction: 30, 30
Reference: 67.50
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 1.21s

============================================================
Query ID: 1041 | Type: Numerical Reasoning | SubType: Counting
============================================================
Predictions:  ['2 2']
Answer:  ['1 3']
Prediction: 2, 2
Reference: 1, 3
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 1.12s

============================================================
Query ID: 1042 | Type: Numerical Reasoning | SubType: Comparison
============================================================
Predictions:  ['20170302 300']
Answer:  ['mar 4 53']
Prediction: 2017-03-02, 30.00
Reference: Mar 4, 53
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 1.77s

============================================================
Query ID: 1043 | Type: Visualization | SubType: LineChart Generation
============================================================
Code: Processing text modality:   2%|▏         | 19/1024 [00:52<1:03:44,  3.81s/it]import pandas as pd
import matplotlib.pyplot as plt
df = pd.read_excel("/data/pan/4xin/datasets/RealHiTBench/tables/health-table14.xlsx")
daily_totals = df[df["Unnamed: 2"] == "DAILY TOTALS"]
dates = daily_totals["DAILY TRACKER"].dropna().astype(str).str.split(" ").str[0]
kcal = daily_totals["Unnamed: 6"].dropna().astype(int)
plt.figure(figsize=(10, 6))
plt.plot(dates, kcal, marker='o', linestyle='-', color='blue')
plt.title('Total Calories Consumed Per Day')
plt.xlabel('Date')
plt.ylabel('Total Calories (Kcal)')
plt.xticks(rotation=45)
plt.grid(True)
plt.tight_layout()
plt.show()

Python Error: x and y must have same first dimension, but have shapes (0,) and (3,)
Prediction: import pandas as pd 
 import matplotlib.pyplot as plt 
 df = pd.read_excel("table.xlsx")
 daily_totals = df[df["Unnamed: 2"] == "DAILY TOTALS"]
 dates = daily_totals["DAILY TRACKER"].dropna().astype(s...
Reference: [[2800, 810, 6180]]

Metrics: {'ECR': False, 'Pass': 'None'}
Processing Time: 8.21s

============================================================
Query ID: 1044 | Type: Fact Checking | SubType: Value-Matching
============================================================
  Warning: Large text input (17902 tokens)
Processing text modality:   2%|▏         | 20/1024 [00:55<57:24,  3.43s/it]  Predictions:  ['dot clark yes']
Answer:  ['steve griggs yes']
Prediction: Dot Clark, Yes
Reference: Steve Griggs, Yes
Metrics: {'F1': 33.33, 'EM': 0.0, 'ROUGE-L': 33.33, 'SacreBLEU': 0.0}
Processing Time: 2.56s
Checkpoint saved: 20 queries processed

============================================================
Query ID: 1045 | Type: Fact Checking | SubType: Multi-hop Fact Checking
============================================================
  Warning: Large text input (17887 tokens)
Processing text modality:   2%|▏         | 21/1024 [00:57<52:24,  3.14s/it]Predictions:  ['2']
Answer:  ['4']
Prediction: 2
Reference: 4
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 2.45s

============================================================
Query ID: 1046 | Type: Numerical Reasoning | SubType: Counting
============================================================
  Warning: Large text input (17883 tokens)
Processing text modality:   2%|▏         | 22/1024 [01:08<1:31:41,  5.49s/it]Predictions:  ['dot clark steve griggs steph mullard andy marsden roger stroud brian thomas del hopkins bill hopkins neil allen mick clark dan calver jody holgarth craig mansfield darren kerrigan richard griggs craig mechan mick salmon matt heskett marc witherden paul marshall susanne roalf richard holloway rosemary rose jason halmshaw dave holt carlos hinds steve aimable dan drake david brown johnny fung julie zhu luke heskett ben rayner scott merry allen mevo nick page darren ball mike blackburn jim doyle adam stavrou ross oneil jo luck steve childs brendan fitzpatrick']
Answer:  ['14']
Prediction: Dot Clark, Steve Griggs, Steph Mullard, Andy Marsden, Roger Stroud, Brian Thomas, Del Hopkins, Bill Hopkins, Neil Allen, Mick Clark, Dan Calver, Jody Holgarth, Craig Mansfield, Darren Kerrigan, Richar...
Reference: 14
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 10.98s

============================================================
Query ID: 1047 | Type: Numerical Reasoning | SubType: Calculation
============================================================
  Warning: Large text input (17889 tokens)
