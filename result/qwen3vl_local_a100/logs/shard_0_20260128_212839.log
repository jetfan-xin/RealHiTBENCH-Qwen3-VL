`torch_dtype` is deprecated! Use `dtype` instead!
Configuration:
  Model: /data/pan/4xin/models/Qwen3-VL-8B-Instruct
  Modality: mix
  Format: html
  Data path: /data/pan/4xin/datasets/RealHiTBench
  Use Flash Attention: True
  Multi-GPU Mode: Model Parallel (device_map=auto)
  Sharding: Shard 1/4
  Generation Settings (Qwen3-VL Instruct Recommended):
    Temperature: 0.7
    Top-p: 0.8
    Top-k: 20
    Repetition Penalty: 1.0
    Presence Penalty: 1.5
    Max Tokens: 32768
  Batch size: 1

Loading Qwen3-VL model from /data/pan/4xin/models/Qwen3-VL-8B-Instruct...
Available GPUs: 1
Using MODEL PARALLELISM (device_map='auto') - layers distributed across GPUs
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.59s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:03<00:03,  1.56s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:04<00:01,  1.55s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.81s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.72s/it]
Model loaded with flash_attention_2 attention
Model distributed across devices: {0}
Processor configured with dynamic resolution: min_pixels=200704, max_pixels=1605632
Successfully loaded F1, EM, ROUGE, SacreBLEU
Shard 0/4: Processing queries 1-768 (768 queries)
Processing mix modality:   0%|          | 0/768 [00:00<?, ?it/s]
============================================================
Query ID: 1 | Type: Fact Checking | SubType: Multi-hop Fact Checking
============================================================
  Warning: Large input (19600 tokens) for image (1814, 3920)
Processing mix modality:   0%|          | 1/768 [00:06<1:17:09,  6.04s/it]Predictions:  ['1953 61179']
Answer:  ['1955 62170']
Prediction: 1953, 61179
Reference: 1955, 62170
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 6.04s

============================================================
Query ID: 2 | Type: Fact Checking | SubType: Inference-based Fact Checking
============================================================
  Warning: Large input (19606 tokens) for image (1814, 3920)
Processing mix modality:   0%|          | 2/768 [00:31<3:42:47, 17.45s/it]Predictions:  ['1953 1954 1955 1956 1957 1958 1959 1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022 2023']
Answer:  ['1954']
Prediction: 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 19...
Reference: 1954
Metrics: {'F1': 2.78, 'EM': 0.0, 'ROUGE-L': 2.78, 'SacreBLEU': 0.51}
Processing Time: 25.44s

============================================================
Query ID: 3 | Type: Fact Checking | SubType: Multi-hop Fact Checking
============================================================
  Warning: Large input (19610 tokens) for image (1814, 3920)
Processing mix modality:   0%|          | 3/768 [00:34<2:18:48, 10.89s/it]Predictions:  ['2022']
Answer:  ['1953']
Prediction: 2022
Reference: 1953
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 3.08s

============================================================
Query ID: 4 | Type: Fact Checking | SubType: Value-Matching
============================================================
  Warning: Large input (19599 tokens) for image (1814, 3920)
Processing mix modality:   1%|          | 4/768 [00:37<1:39:54,  7.85s/it]Predictions:  ['161037']
Answer:  ['158772']
Prediction: 161037
Reference: 158772
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 3.18s

============================================================
Query ID: 5 | Type: Data Analysis | SubType: Rudimentary Analysis
============================================================
  Warning: Large input (19619 tokens) for image (1814, 3920)
Processing mix modality:   1%|          | 5/768 [00:41<1:19:16,  6.23s/it]Predictions:  ['57 13']
Answer:  ['58 16']
Prediction: 5.73, 1.29
Reference: 5.80, 1.62
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 3.37s

============================================================
Query ID: 6 | Type: Data Analysis | SubType: Summary Analysis
============================================================
  Warning: Large input (19602 tokens) for image (1814, 3920)
Processing mix modality:   1%|          | 6/768 [00:58<2:08:33, 10.12s/it]Prediction: This table presents annual averages of employment status for the civilian noninstitutional population in the U.S. from 1953 to 2023. Key columns include: "Year" (time period), "Civilian noninstitution...
Reference: The table provides employment data for the civilian noninstitutional population from 1953 onward. Main columns include 'Year,' 'Civilian Population,' 'Labor Force,' 'Employed (Total, Agriculture, Nona...
Metrics: {'GPT_EVAL': 'N/A (no eval_api_key)'}
Processing Time: 17.67s

============================================================
Query ID: 7 | Type: Data Analysis | SubType: Predictive Analysis
============================================================
  Warning: Large input (19667 tokens) for image (1814, 3920)
Processing mix modality:   1%|          | 7/768 [01:02<1:39:49,  7.87s/it]Predictions:  ['589 increasing trend']
Answer:  ['predicted percentage for 1965 551']
Prediction: 58.9, Increasing trend
Reference: Predicted percentage for 1965: 55.12%
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 3.23s

============================================================
Query ID: 8 | Type: Data Analysis | SubType: Exploratory Analysis
============================================================
  Warning: Large input (19787 tokens) for image (1814, 3920)
Processing mix modality:   1%|          | 8/768 [01:05<1:21:25,  6.43s/it]Predictions:  ['strong positive correlation 10']
Answer:  ['strong positive correlation 10']
Prediction: Strong positive correlation, 0.99
Reference: Strong positive correlation, 1.00
Metrics: {'F1': 100.0, 'EM': 100.0, 'ROUGE-L': 100.0, 'SacreBLEU': 100.0}
Processing Time: 3.34s

============================================================
Query ID: 9 | Type: Data Analysis | SubType: Anomaly Analysis
============================================================
  Warning: Large input (19589 tokens) for image (1814, 3920)
Processing mix modality:   1%|          | 9/768 [01:08<1:10:04,  5.54s/it]Prediction: 1975, 1982, 2020
Reference: 4 anomalies detected - Year 1982: Unemployment 9.70% or Employment 99526.00 deviates significantly, Year 1983: Unemployment 9.600% or Employment 100834.00 deviates significantly, Year 2009: Unemployme...
Metrics: {'GPT_EVAL': 'N/A (no eval_api_key)'}
Processing Time: 3.58s

============================================================
Query ID: 10 | Type: Fact Checking | SubType: Value-Matching
============================================================
  Warning: Large input (21598 tokens) for image (1814, 4304)
Processing mix modality:   1%|▏         | 10/768 [01:13<1:04:14,  5.09s/it]Predictions:  ['1983']
Answer:  ['1983']
Prediction: 1983
Reference: 1983
Metrics: {'F1': 100.0, 'EM': 100.0, 'ROUGE-L': 100.0, 'SacreBLEU': 0.0}
Processing Time: 4.07s
Checkpoint saved: 10 queries processed

============================================================
Query ID: 11 | Type: Fact Checking | SubType: Multi-hop Fact Checking
============================================================
  Warning: Large input (21607 tokens) for image (1814, 4304)
Processing mix modality:   1%|▏         | 11/768 [01:16<56:58,  4.52s/it]  Predictions:  ['yes']
Answer:  ['no']
Prediction: Yes
Reference: No
Metrics: {'F1': 0.0, 'EM': 0.0, 'ROUGE-L': 0.0, 'SacreBLEU': 0.0}
Processing Time: 3.22s

============================================================
Query ID: 12 | Type: Fact Checking | SubType: Inference-based Fact Checking
============================================================
  Warning: Large input (21597 tokens) for image (1814, 4304)
